metadata:
  version: "1.1"
  description: "基于增强参数传递的多模型问答汇总工作流"

input:
  type: "start"
  name: "workflow_input"
  data:
    question: ""  # 这将由运行时输入填充

executors:
  - name: text_processing
    type: "task"
    func: text_process
    custom_vars:
      text: "${workflow_input.question}"

  - name: model1_answer
    type: "task"
    func: llm_simple_call
    custom_vars:
      user_input: "${text_processing.output}"
      model: "gemma3:1b"
    depends_on: ["text_processing"]

  - name: model2_answer
    type: "task"
    func: llm_simple_call
    custom_vars:
      user_input: "${text_processing.output}"
      model: "qwen2.5:0.5b"
    depends_on: ["text_processing"]

  - name: model3_answer
    type: "task"
    func: llm_simple_call
    custom_vars:
      user_input: "${text_processing.output}"
      model: "qwen2.5:0.5b"
    depends_on: ["text_processing"]



  # 使用新的引用格式进行深度分析
  - name: deep_analysis
    type: "task"
    func: llm_simple_call
    custom_vars:
      user_input: "请对以下回答进行深度分析，提取关键信息和观点：${model1_answer.output} \n\n ${model2_answer.output} \n\n ${model3_answer.output} "
      model: "gemma3:1b"
    depends_on: ["model1_answer", "model2_answer", "model3_answer"]


  - name: summary_step
    type: "task"
    func: llm_simple_call
    custom_vars:
      user_input: "请对以下深度分析进行总结：${deep_analysis.output}"
      model: "deepseek-r1:7b"
    depends_on: ["deep_analysis"]

output:
  type: "end"
  name: "workflow_output"
  data:
    original_question: "${workflow_input.question}"
    processed_question: "${text_processing.output}"
    model_answers:
      gemma3_1b: "${model1_answer.output}"
      qwen2_5_0_5b: "${model2_answer.output}"
      deepseek_r1_1_5b: "${model3_answer.output}"
    deep_analysis: "${deep_analysis.output}"
    final_result: "${summary_step.output}"
